:topic_type: task

[.task]
== Connect Terraform Enterprise (Run Tasks)

With the integration of Terraform Enterprise, Prisma Cloud scans your Terraform frameworks to identify misconfigurations based on Prisma Cloudâ€™s default policies, as well as custom policies created by your organization for specific needs. This scanning process occurs whenever changes are pushed or triggered in your workflow, ensuring security checks are integrated seamlessly. Prisma Cloud identifies issues such as misconfigurations in your infrastructure-as-code (IaC) files, software composition analysis (SCA) vulnerabilities^*^, exposed secrets, and license non-compliance as soon as they are introduced.

^*^Prisma Cloud performs 'Image Referencer scans to analyze the contents, dependencies, and configurations of container images in order to detect known vulnerabilities, as full SCA scans are not supported for Terraform Cloud (Run Tasks).

////
Integrate Prima Cloud with Terraform Enterprise (Run Tasks) to enforce the policy as a code framework for Terraform https://www.terraform.io/cloud-docs/workspaces[workspaces] that use https://www.terraform.io/cloud-docs/sentinel[Sentinel language] with a predefined https://www.terraform.io/cloud-docs/sentinel/manage-policies#enforcement-levels[enforcement level] that prevents any risky Terraform run. With Terraform Enterprise (Run Tasks) integration, Prisma Cloud will scan your Terraform frameworks for any misconfiguration in Prisma Cloud default policies, out-of-the-box policies and custom policies.
////
 
Runs in Terraform are exclusively performed within a workspace, or a working directory when running Terraform locally. The workspace provides providing the configuration, state, and variables for the run. Terraform Enterprise maintains a run queue, processing runs sequentially. Each run progresses through multiple run stages; pending, plan, cost estimation, policy check, apply, and completion. 

Users can monitor the run status (pass/fail) directly on the Prisma Cloud console. In addition, you can track the run status on Terraform Cloud through streamlined run task reviews, which offer detailed descriptions of violations and fixes provided by Prisma Cloud within their Terraform deployment environment. For more information about streamlined tasks, refer to https://www.hashicorp.com/blog/terraform-cloud-adds-streamlined-run-task-reviews.

////
 Terraform always performs runs for a workspace. Therefore, the workspace serves as a working directory when running Terraform locally, providing the configuration, state, and variables for the run. Each workspace is associated with a particular Terraform configuration, where Terraform Enterprise maintains a queue for runs and processes those runs in order. Each run passes through multiple run stages (pending, plan, cost estimation, policy check, apply, and completion), and this integration communicates the status of the run (either pass or fail) that is accessible on the Prisma Cloud console.
////

[.procedure]

. Verify the prerequisites.
+
* *Terraform Enterprise Console*: Access to Terraform Enterprise console enables you to provide a user or team token that authorizes Prisma Cloud to access workspaces and helps regulate run configuration in Terraform console

* *Terraform Enterprise version compatibility*: Run Tasks for workspaces on Terraform Enterprise is compatible with version 1.1.9 and above. 

* *Terraform Enterprise user or team permission*: For a workspace integration of run tasks you need https://developer.hashicorp.com/terraform/enterprise/users-teams-organizations/permissions#organization-permissions[Manage Run Tasks permissions]. The token must also either have the *Manage workspaces* permission at the organization level or be granted admin access to the workspace(s) being integrated. This enables Prisma Cloud to configure run tasks in the environment and scan plan files from your runs

. On the Prisma Cloud Application Security console.
.. In Application Security, select *Home* > *Settings* > *Connect Provider* > *Code & Build Providers*.
+
image::application-security/connect-provider-menu.png[]

.. Select *Terraform Cloud (Run Tasks)* (under CI/CD Runs) in the catalog that is displayed.
+
image::application-security/connect-provider.png[]
+
The *Configure Account* step of the integration wizard is displayed.
+
image::application-security/tfe-runtasks-config-account-wizard.png.png[]

.. Fill in the provided fields: 
+
* Add your Terraform *User or Team token* in the provided field
* Add your *Domain* > *Next*.
+
NOTE: Ensure that your IP address and your Terraform Enterprise URL are on the allow list for Prisma Cloud. For more about the allow list see xref:../../../../get-started/console-prerequisites.adoc[allow list].
+
The *Select Organization* step of the integration wizard is displayed. 

. Select an organization > *Next*.
+
The *Select workspace* step of the integration wizard is displayed. 
+
NOTE: Prisma Cloud creates event hooks for a Terraform Enterprise organization to receive run task notification from Terraform Enterprise.  

. Select a workspace to scan during the Terraform Enterprise run lifecycle > *Next*.
+
NOTE: You can select multiple workspaces for Prisma Cloud to scan during the Terraform Enterprise run lifecycle.
+
The *Status* step of the integration wizard opens.

. Verify the Terraform Enterprise (Run Tasks) integration with Prisma Cloud.
+
* A *New integration successfully configured* message appears after integration is successfully set up and then select *Done*.
* Access *Application Security > Projects* to view the latest integrated Terraform Enterprise (Run Tasks) repository
+
NOTE: A Terraform Enterprise run may fail if a Run Task configuration for a workspace is set at *Mandatory.* You can re-configure the severity level using xref:../../../risk-management/monitor-and-manage-code-build/enforcement.adoc[Enforcement].

. Next step: xref:../../../risk-management/monitor-and-manage-code-build/monitor-fix-issues-in-scan.adoc[Remediate] the policy misconfigurations.

=== Manage Integrations
 
You can view, modify, delete and add integrations. 

[#access-management]
==== Access Integration Management

To access integration management, in *Application Security*, select *Settings* > *Connect Provider* > *Code & Build Providers* > *Terraform Enterprise (Run Tasks)* (under CI/CD Runs).
+
The *Terraform Cloud Run Tasks* popup opens, displaying a list of configured accounts.

[.task]
==== Modify Integrations

Modify existing integrations by choosing an alternative workspace.

[.procedure]

. <<#access-management,Access Integration Management>>.
. Select the menu under the *Actions* column of an account.
. Click *Reselect workspaces*.
+
The *Select Workspace* step of the integration wizard is displayed.
. Select a workspace and complete the remaining steps in the integration wizard.

==== Add Integrations

Add additional integrations as needed to expand your workflow.

. <<#access-management,Access Integration Management>>.
. Select the menu under the *Actions* column of an account.

. Select *Add an account*.
+
The *Configure Account* step of the integration wizard is displayed. 
. Repeat the integration process above.

==== View Integrations

View a list of integrations on a single console. 

. <<#access-management,Access Integration Management>>.
+
The *Terraform Cloud Run Tasks* popup displays a list of integrations,including their organization and workspace.

==== Delete Integrations

. <<#access-management,Access Integration Management>>.
. Select the menu under the *Actions* column of an organization.
. Click *Delete integration*.
+
NOTE: If you have a single integration within the account, deleting the existing integration will delete the account configuration on Prisma Cloud console.

