
== Azure Synapse Workspace vulnerability assessment is disabled

=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
| f0f026d1-72ee-47dd-9543-53fe130f2471

|Checkov ID
| https://github.com/bridgecrewio/checkov/blob/main/checkov/terraform/checks/graph_checks/azure/AzureSynapseWorkspaceVAisEnabled.yaml[CKV2_AZURE_46]

|Severity
|MEDIUM

|Subtype
|Run,Build

|Frameworks
|Terraform,TerraformPlan

|===

=== Description

This policy identifies Azure Synpase workspace which has Vulnerability Assessment setting disabled. Vulnerability Assessment service scans Synapse workspaces for known security vulnerabilities and highlight deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. It is recommended to enable Vulnerability assessment on Synapse workspaces.

=== Fix - Buildtime

*Terraform*

* *Resource:* azurerm_synapse_workspace_security_alert_policy, azurerm_synapse_workspace, azurerm_synapse_workspace_vulnerability_assessment
* *Arguments:* TBD

To fix this issue, you need to enable the vulnerability assessment in the Azure Synapse Workspace.

[source,go]
----
resource "azurerm_synapse_workspace" "synapse_ws_pass_1" {
  ...
}

resource "azurerm_synapse_workspace_security_alert_policy" "synapse_ws_policy_1" {
  synapse_workspace_id       = azurerm_synapse_workspace.synapse_ws_pass_1.id
  policy_state               = "Enabled"

  ...
}

resource "azurerm_synapse_workspace_vulnerability_assessment" "va_pass" {
  workspace_security_alert_policy_id = azurerm_synapse_workspace_security_alert_policy.synapse_ws_policy_1.id
  ...

  recurring_scans {
    enabled = true
  }
}
----

This code is now secure because it enables the vulnerability assessment feature on Azure Synapse. This feature proactively discovers, tracks, and helps you remediate potential database vulnerabilities, thereby improving the security of your synapse workspace. This feature can be scheduled to perform weekly scans and it uses a Storage Account to store the detected vulnerabilities.

