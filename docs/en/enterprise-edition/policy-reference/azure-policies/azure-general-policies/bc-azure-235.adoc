
== Azure Container Instance environment variable with regular value type

=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
| 743e8910-6a4c-466c-8ba2-d9c207a5efe6

|Checkov ID
| https://github.com/bridgecrewio/checkov/blob/main/checkov/terraform/checks/resource/azure/AzureContainerInstanceEnvVarSecureValueType.py[CKV_AZURE_235]

|Severity
|LOW

|Subtype
|Run,Build

|Frameworks
|Terraform,TerraformPlan

|===

=== Description

This policy identifies Azure Container Instances (ACI) in which the environment variables with regular value type instead of the secure values property. Objects with secure values are intended to hold sensitive information like passwords or keys for your application. Using secure values for environment variables is both safer and more flexible than including them in your container's image. So it is recommended to secure the environment variable by specifying the 'secureValue' property instead of the regular 'value' for the variable's type.


=== Fix - Buildtime

*Terraform*

* *Resource:* azurerm_container_group
* *Arguments:* environment_variables

In order to fix this issue, you need to ensure that the environment variables in your Azure container are securely configured not using environment variables. Consider using `secure_environment_variables` or other methods instead.

[source,go]
----
resource "azurerm_container_group" "fail_1" {
  ...

  init_container {
    ...
-    environment_variables = {
-      ENV_INIT_FAIL_1 = random_string.pud-random-str
-    }
 }
}
----

