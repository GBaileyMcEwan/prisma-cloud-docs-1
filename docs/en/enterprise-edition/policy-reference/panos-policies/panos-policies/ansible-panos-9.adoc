== No Log Forwarding Profile is selected for a security policy rule

=== Policy Details 

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| TBD

|Checkov ID 
| https://github.com/bridgecrewio/checkov/blob/main/checkov/ansible/checks/graph_checks/PanosPolicyLogForwarding.yaml[CKV_PAN_9]

|Severity
|LOW

|Subtype
|Build

|Frameworks
|Ansible

|=== 

=== Description

This policy ensures that each security policy rule in Palo Alto Networks devices has a Log Forwarding Profile associated with it. Log Forwarding Profiles are crucial for monitoring, troubleshooting, and auditing, as they define what logs are forwarded and where they are sent. This check verifies that the `log_setting` attribute in `panos_security_rule` resources is populated, indicating that logs generated by the rule are properly forwarded for analysis and storage.

=== Fix - Buildtime

*Palo Alto Networks*

* *Resource:* panos_security_rule
* *Attribute:* log_setting

To adhere to this policy, ensure that the `log_setting` attribute in your `panos_security_rule` resources is defined and points to an existing Log Forwarding Profile. This setup ensures that activity logs for each rule are captured and forwarded correctly, facilitating effective monitoring and analysis.

Secure code example:

[source,yaml]
----
- name: Ensure log forwarding is configured for security rules
  tasks:
    - name: Security_rule_pass_1
      paloaltonetworks.panos.panos_security_rule:
        ...
+        log_setting: 'default'
----

Configuring the `log_setting` attribute with a valid Log Forwarding Profile name for each security rule complies with this policy, ensuring that logging is properly implemented for security monitoring and analysis.
